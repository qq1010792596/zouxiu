"use strict";var goodsList=[{id:1234567876,imgUrl:"img/3.jpg",goodsInfo:"号地块健身房回复的科技示范户快速坚实的看了看大家发快递了很费劲的开始放假",goodsParams:"四季度后付款的酸辣粉",price:199,goodsCount:1,singleGoodsMoney:199},{id:145564876,imgUrl:"img/4.jpg",goodsInfo:"号地块健身房回复的科技示范户快速坚实的看了看大家发快递了很费劲的开始放假",goodsParams:"四季度后付款的酸辣粉",price:299,goodsCount:2,singleGoodsMoney:598},{id:1234564876,imgUrl:"img/5.jpg",goodsInfo:"号地块健身房回复的科技示范户快速坚实的看了看大家发快递了很费劲的开始放假",goodsParams:"块电费简单来说记录",price:399,goodsCount:1,singleGoodsMoney:399},{id:12345623876,imgUrl:"img/6.jpg",goodsInfo:"号地块健身房回复的科技示范户快速坚实的看了看大家发快递了很费劲的开始放假",goodsParams:"块电费简单来说记录",price:399,goodsCount:1,singleGoodsMoney:399}],deleteGoods=null;function loadGoods(){$.each(goodsList,function(e,o){o='<div class="goods-item"><div class="panel panel-default"><div class="panel-body"><div class="col-md-1 car-goods-info"><label><input type="checkbox" class="goods-list-item"/></label></div><div class="col-md-3 car-goods-info goods-image-column"><img class="goods-image" src="'+o.imgUrl+'" style="width: 100px; height: 100px;" /><span id="goods-info">'+o.goodsInfo+'</span></div><div class="col-md-3 car-goods-info goods-params">'+o.goodsParams+'</div><div class="col-md-1 car-goods-info goods-price"><span>￥</span><span class="single-price">'+o.price+'</span></div><div class="col-md-1 car-goods-info goods-counts"><div class="input-group"><div class="input-group-btn"><button type="button" class="btn btn-default car-decrease">-</button></div><input type="text" class="form-control goods-count" value="'+o.goodsCount+'"><div class="input-group-btn"><button type="button" class="btn btn-default car-add">+</button></div></div></div><div class="col-md-1 car-goods-info goods-money-count"><span>￥</span><span class="single-total">'+o.singleGoodsMoney+'</span></div><div class="col-md-2 car-goods-info goods-operate"><button type="button" class="btn btn-danger item-delete">删除</button></div></div></div></div>';$(".goods-content").append(o)})}function ShoppingCarObserver(e,o){e&&(this.elInput=e,this.parents=this.elInput.parents(".goods-item"),this.count=parseInt(this.elInput.val()),this.singlePrice=parseFloat(this.parents.find(".single-price").text())),o&&(this.isAdd=o),this.computeGoodsMoney=function(){var e=this.count*this.singlePrice,o=this.parents.find(".single-total");console.log(e),o.empty().append(e)},this.showCount=function(){var e=this.parents.find(".goods-list-item")[0].checked,o=parseFloat($("#selectGoodsMoney").text()),s=parseInt($("#selectGoodsCount").text());if(this.elInput){if(this.isAdd)++this.count,e&&($("#selectGoodsMoney").empty().append(o+this.singlePrice),$("#selectGoodsCount").empty().append(s+1));else{if(parseInt(this.count)<=1)return;--this.count,e&&($("#selectGoodsMoney").empty().append(o-this.singlePrice),$("#selectGoodsCount").empty().append(s-1))}this.elInput.val(this.count)}},this.checkIsAll=function(){var e=$(".goods-list-item:checked").length;0<e?$(".submitData").removeClass("submitDis"):$(".submitData").addClass("submitDis"),$(".goods-item").length===e&&0<e?$("#checked-all-bottom, #check-goods-all").prop("checked",!0):$("#checked-all-bottom, #check-goods-all").prop("checked",!1)},this.checkedChange=function(e){void 0===e&&(e=this.parents.find(".goods-list-item")[0].checked);var o=parseFloat(this.parents.find(".single-total").text()),s=parseFloat($("#selectGoodsMoney").text()),t=parseInt(this.parents.find(".goods-count").val()),i=parseInt($("#selectGoodsCount").text());e?($("#selectGoodsMoney").empty().append(o+s),$("#selectGoodsCount").empty().append(t+i)):(s-o==0?($("#selectGoodsMoney").empty().append("0.00"),$(".submitData").hasClass("submitDis")||$(".submitData").addClass("submitDis")):$("#selectGoodsMoney").empty().append(s-o),$("#selectGoodsCount").empty().append(i-t))},this.deleteGoods=function(){this.parents.find(".goods-list-item")[0].checked&&this.checkedChange(!1),this.parents.remove(),this.checkOptions()},this.checkOptions=function(){$("#check-goods-all")[0].checked?$(".goods-list-item").length<=0&&$("#checked-all-bottom, #check-goods-all").prop("checked",!1):this.checkIsAll()}}function checkedAll(e){$(".goods-item").length<=0?$(".submitData").addClass("submitDis"):$(".submitData").removeClass("submitDis");for(var o=0;o<$(".goods-item").length;o++){var s=$(".goods-item").eq(o).find(".goods-list-item"),t=$(".goods-item").eq(o).find(".goods-list-item")[0].checked,i=new ShoppingCarObserver(s,null);e.checked?t||(s.prop("checked",!0),i.checkedChange(!0)):($(".submitData").hasClass("submitDis")||$(".submitData").addClass("submitDis"),t&&(s.prop("checked",!1),i.checkedChange(!1)))}}loadGoods(),$("#check-goods-all").on("change",function(){this.checked?$("#checked-all-bottom").prop("checked",!0):$("#checked-all-bottom").prop("checked",!1),checkedAll(this)}),$("#checked-all-bottom").on("change",function(){this.checked?$("#check-goods-all").prop("checked",!0):$("#check-goods-all").prop("checked",!1),checkedAll(this)}),$(".goods-list-item").on("change",function(){var e=new ShoppingCarObserver($(this),null);e.checkedChange(),e.checkIsAll()}),$(".goods-content").on("click",".car-decrease",function(){var e=new ShoppingCarObserver($(this).parents(".input-group").find(".goods-count"),!1);e.showCount(),e.computeGoodsMoney()}),$(".goods-content").on("click",".car-add",function(){var e=new ShoppingCarObserver($(this).parents(".input-group").find(".goods-count"),!0);e.showCount(),e.computeGoodsMoney()}),$(".goods-content").on("click",".item-delete",function(){var e=$(this).parents(".goods-item").find(".goods-list-item");deleteGoods=new ShoppingCarObserver(e,null),$("#deleteItemTip").modal("show")}),$(".deleteSure").on("click",function(){null!==deleteGoods&&deleteGoods.deleteGoods(),$("#deleteItemTip").modal("hide")}),$("#deleteMulty").on("click",function(){($(".goods-list-item:checked").length<=0?$("#selectItemTip"):$("#deleteMultyTip")).modal("show")}),$(".deleteMultySure").on("click",function(){for(var e=0;e<$(".goods-list-item:checked").length;e++)new ShoppingCarObserver($(".goods-list-item:checked").eq(e),null).deleteGoods(),e--;(new ShoppingCarObserver).checkOptions(),$("#deleteMultyTip").modal("hide")});